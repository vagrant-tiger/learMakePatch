in this patch, I fix some bugs.
